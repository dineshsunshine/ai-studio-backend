## ðŸ”§ Video API Corrections - Frontend Integration Fix

### Issue 1: Delete Video from Look âŒ â†’ âœ…

**WRONG (doesn't exist):**
```
DELETE /api/v1/looks/{lookId}/videos/{videoId}
```

**CORRECT:**
```
DELETE /api/v1/video-jobs/{videoId}
```

**Frontend Fix:**
```javascript
// OLD (WRONG):
// await fetch(`/looks/${lookId}/videos/${videoId}`, { method: 'DELETE' })

// NEW (CORRECT):
const deleteVideo = async (videoId) => {
  const response = await fetch(`${API_BASE}/api/v1/video-jobs/${videoId}`, {
    method: 'DELETE',
    headers: { 'Authorization': `Bearer ${token}` }
  });
  return response.status === 204; // Success
};
```

---

### Issue 2: Set Video as Default for Look âŒ â†’ âœ…

**WRONG (doesn't exist):**
```
PATCH /api/v1/looks/{lookId}/videos/{videoId}/set-default
```

**CORRECT:**
```
PATCH /api/v1/video-jobs/{videoId}/set-default-for-look/{lookId}
```

**Frontend Fix:**
```javascript
// OLD (WRONG):
// await fetch(`/looks/${lookId}/videos/${videoId}/set-default`, { method: 'PATCH' })

// NEW (CORRECT):
const setVideoAsDefault = async (videoId, lookId) => {
  const response = await fetch(
    `${API_BASE}/api/v1/video-jobs/${videoId}/set-default-for-look/${lookId}`,
    {
      method: 'PATCH',
      headers: { 'Authorization': `Bearer ${token}` }
    }
  );
  
  if (response.status === 200) {
    return await response.json(); // Success
  }
  throw new Error('Failed to set default');
};
```

---

### Issue 3: List Video Jobs Returns 405 âŒ â†’ âœ…

**WRONG (incorrect query parameters):**
```
GET /api/v1/video-jobs?offset=0&limit=100
```

**CORRECT (use skip instead of offset):**
```
GET /api/v1/video-jobs?skip=0&limit=100
```

**Frontend Fix:**
```javascript
// OLD (WRONG):
// await fetch(`${API_BASE}/api/v1/video-jobs?offset=0&limit=100`, ...)

// NEW (CORRECT):
const listVideoJobs = async (skip = 0, limit = 20) => {
  const token = localStorage.getItem('authToken');
  const response = await fetch(
    `${API_BASE}/api/v1/video-jobs?skip=${skip}&limit=${limit}`,
    {
      method: 'GET',
      headers: { 'Authorization': `Bearer ${token}` }
    }
  );
  
  if (response.status === 200) {
    return await response.json(); // Returns { items: [...], total: number, skip: number, limit: number }
  }
  throw new Error('Failed to list videos');
};
```

**Response Format:**
```json
{
  "items": [
    {
      "id": "video-id",
      "status": "SUCCEEDED",
      "cloudinary_url": "https://res.cloudinary.com/...",
      "progress_percentage": 100,
      "created_at": "2025-11-02T10:30:00.000Z"
    }
  ],
  "total": 42,
  "skip": 0,
  "limit": 20
}
```

**Optional Query Parameters:**
- `status_filter`: Filter by status (PENDING, RUNNING, SUCCEEDED, FAILED)
- `skip`: Number of videos to skip (default: 0)
- `limit`: Max results (default: 50, max: 100)

---

### Key Reminders

âœ… **All video operations** go through `/api/v1/video-jobs` endpoints  
âœ… **Never use** `/api/v1/looks/{lookId}/videos/` paths  
âœ… For **delete**: path is `/api/v1/video-jobs/{videoId}`  
âœ… For **set default**: path is `/api/v1/video-jobs/{videoId}/set-default-for-look/{lookId}`  
âœ… Both endpoints require **JWT authentication**  
âœ… Both return **200 OK** on success (delete returns 204 No Content)  

---

### Quick Test with curl

**Test Delete:**
```bash
curl -X DELETE "https://zestfully-chalky-nikia.ngrok-free.dev/AIStudio/api/v1/video-jobs/{videoId}" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

**Test Set Default:**
```bash
curl -X PATCH "https://zestfully-chalky-nikia.ngrok-free.dev/AIStudio/api/v1/video-jobs/{videoId}/set-default-for-look/{lookId}" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

---

**For detailed integration guide, see:** `FRONTEND_VIDEO_JOBS_MANAGEMENT.txt`
